{% extends "admin/base_site.html" %}
{% load i18n admin_urls %}

{% block content %}
<h1>Duplicar Projeto (Template)</h1>

<p>Você está duplicando o projeto: <strong>{{ projeto.titulo }}</strong></p>
<p>Empresa origem: <strong>{{ projeto.empresa.nome }}</strong></p>
<p>Total de etapas: <strong>{{ projeto.total_etapas }}</strong></p>

<form method="post">
    {% csrf_token %}

    <fieldset class="module aligned">
        <h2>Selecione as empresas de destino</h2>

        <div class="form-row">
            <p class="help" style="margin-bottom: 10px;">Marque as empresas para as quais deseja duplicar este projeto:</p>
            {% for empresa in empresas %}
            <label style="display: block; margin: 5px 0; padding: 8px; background: {% if empresa.id == projeto.empresa_id %}#fffde7{% else %}#f5f5f5{% endif %}; border-radius: 4px;">
                <input type="checkbox" name="empresas" value="{{ empresa.id }}" {% if empresa.id == projeto.empresa_id %}disabled{% endif %}>
                {{ empresa.nome }}
                {% if empresa.id == projeto.empresa_id %}<span style="color: #999;">(origem)</span>{% endif %}
            </label>
            {% endfor %}
        </div>
    </fieldset>

    <fieldset class="module aligned">
        <h2>O que será duplicado</h2>
        <ul style="margin-left: 20px;">
            <li>Projeto com título, descrição e cor</li>
            <li>Todas as {{ projeto.total_etapas }} etapa(s)/demanda(s)</li>
            <li>Subtarefas de cada etapa</li>
        </ul>
        <p class="help">Os prazos serão ajustados relativamente à data de hoje. Status resetado para "Planejamento".</p>
    </fieldset>

    <fieldset class="module aligned">
        <h2>Opções</h2>

        <div class="form-row">
            <label>Prazo do projeto:</label>
            <input type="date" name="prazo_projeto" style="padding: 5px;">
            <p class="help">Deixe vazio para calcular automaticamente baseado nas etapas</p>
        </div>

        <div class="form-row">
            <label>Dias para cada etapa (a partir de hoje):</label>
            <input type="number" name="dias_por_etapa" value="7" min="1" max="365" style="width: 80px; padding: 5px;">
            <p class="help">Cada etapa terá prazo de X dias após a anterior</p>
        </div>
    </fieldset>

    <div class="submit-row">
        <input type="submit" value="Duplicar para Empresas Selecionadas" class="default">
        <a href="{% url 'admin:checklists_projeto_changelist' %}" class="button cancel-link">Cancelar</a>
    </div>
</form>
{% endblock %}
